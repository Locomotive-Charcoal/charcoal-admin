/*! @locomotivemtl/charcoal-admin 20-03-2019 */

!function(t,e){var n,i,a;n=t.util.Tools.each,i=t.util.Tools.extend,a=t.util.Tools.isArray,t.create("tinymce.plugins.Charcoal",{dependencies:["advlist"],listItems:["bullist","numlist","outdent","indent"],alignItems:["alignleft","aligncenter","alignright","alignjustify"],editor:null,init:function(i){var o,l,r;o=this,this.editor=i,l=this.filterItems(this.listItems),r=this.filterItems(this.alignItems),i.addMenuItem("lists",{text:"Lists",context:"format",menu:l}),i.addMenuItem("alignment",{text:"Alignment",context:"format",menu:r}),i.addButton("alignment",{type:"menubutton",title:"Alignment",icon:o.getDefaultAlignment(),menu:r,onPostRender:function(){var t=this;i.on("NodeChange",function(e){var n,l;l=this.formatter.matchAll(o.alignItems),a(l)&&(l=l.pop()),l?"IMG"===e.element.nodeName&&(n=i.dom.getParent(e.element,"figure")||e.element,"alignnone"===l?t.active(!/\bu-align-(left|center|right)\b/.test(n.className)):t.active(i.dom.hasClass(n,l))):l=o.getDefaultAlignment(),t.icon(l)})}}),i.on("init",function(){var a,o,l,r;a=t.Env,o=i.getDoc(),l=i.dom,(r=["charcoal-editor"]).push("mceContentBody"),"rtl"===i.getParam("directionality")&&(r.push("rtl"),l.setAttrib(o.documentElement,"dir","rtl")),l.setAttrib(o.documentElement,"lang",i.getParam("root_lang_attr")),a.ie&&(9===parseInt(a.ie,10)?r.push("lt-ie10"):8===parseInt(a.ie,10)?r.push("lt-ie9"):a.ie<8&&r.push("lt-ie8")),n(r,function(t){t&&l.addClass(o.body,t)}),i.getParam("autohide_toolbar")&&e(i.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide(),i.getParam("autohide_menubar")&&e(i.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()}),i.getParam("autohide_toolbar")&&(i.on("focus",function(){e(i.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").show()}),i.on("blur",function(){e(i.getContentAreaContainer().parentElement).find("div.mce-toolbar-grp").hide()})),i.getParam("autohide_menubar")&&(i.on("focus",function(){e(i.getContentAreaContainer().parentElement).find("div.mce-menubar").show()}),i.on("blur",function(){e(i.getContentAreaContainer().parentElement).find("div.mce-menubar").hide()})),!1===i.getParam("image_dimensions")&&i.on("NodeChange",function(e){e&&"img"===e.element.nodeName.toLowerCase()&&t.DOM.setAttribs(e.element,{width:null,height:null})})},getDefaultAlignment:function(){return"rtl"===this.editor.getParam("directionality")?"alignright":"alignleft"},filterItems:function(t){var e,o;return e=this.editor,o=[],a(t)||(t=t.split(" ")),n(t,function(t){var n;"|"===t?o.push({text:"-"}):t in e.buttons&&((n=i({},e.buttons[t])).text=n.tooltip,delete n.tooltip,delete n.type,o.push(n))}),o}}),t.PluginManager.add("charcoal",t.plugins.Charcoal,t.plugins.Charcoal.dependencies)}(window.tinymce,window.jQuery);